meta:
  name: ASTROLOGY_RULES_v2.15.4_single
  version: 2.15.4
  profile_default: AP-SUPER
  notes:
  - Always-evaluate interpretive channels; tag by default; promote when thresholds
    are met.
  - Predictive corridor stays lean; no smoothing; robust zscore→tanh ±100.
  - File-type-aware dataset resolver; minimal profile set (LITE, SUPER, EXTREME, DEBUG).
engine:
  house: whole
  node: true
  tz: America/New_York
  reloc: 'no'
  sidereal: 'no'
  stars: precess
  sf: 'on'
  tob: est±0:45
timing:
  bin_minutes: 60
  smoothing_bins: 1
performance:
  vectorize: true
  cache_positions: true
  prefilter_orb_margin_deg: 3.0
  max_hits_per_channel_per_hour: 50
  max_tag_list_len: 6
  prefer_exact_sort: true
aspects:
- name: conjunction
  angle: 0
  weight: 1.0
  orb_mult: 1.0
- name: sextile
  angle: 60
  weight: 0.6
  orb_mult: 0.85
- name: square
  angle: 90
  weight: 0.95
  orb_mult: 0.9
- name: trine
  angle: 120
  weight: 0.8
  orb_mult: 0.9
- name: opposition
  angle: 180
  weight: 1.0
  orb_mult: 1.0
minor_aspects:
- name: quincunx
  angle: 150
  weight: 0.45
  orb_mult: 0.8
- name: semisextile
  angle: 30
  weight: 0.35
  orb_mult: 0.75
- name: semisquare
  angle: 45
  weight: 0.5
  orb_mult: 0.8
- name: sesquisquare
  angle: 135
  weight: 0.5
  orb_mult: 0.8
orbs_deg_by_transit:
  Moon: 6.0
  Sun: 5.0
  Mercury: 4.0
  Venus: 4.0
  Mars: 3.5
  Jupiter: 3.0
  Saturn: 3.0
  Uranus: 2.5
  Neptune: 2.5
  Pluto: 2.0
weights_by_transit:
  Moon: 0.4
  Sun: 0.6
  Mercury: 0.5
  Venus: 0.55
  Mars: 0.85
  Jupiter: 0.75
  Saturn: 1.0
  Uranus: 1.05
  Neptune: 0.85
  Pluto: 1.1
energy_type_by_transit:
  Moon: sharp/flashpoint
  Sun: sharp/flashpoint
  Mercury: sharp/flashpoint
  Venus: sharp/flashpoint
  Mars: sharp/flashpoint
  Jupiter: broad/background
  Saturn: broad/background
  Uranus: broad/background
  Neptune: broad/background
  Pluto: broad/background
event_precision_by_transit:
  Moon: day-specific
  Sun: day-specific
  Mercury: day-specific
  Venus: day-specific
  Mars: day-specific
  Jupiter: windowed only
  Saturn: windowed only
  Uranus: windowed only
  Neptune: windowed only
  Pluto: windowed only
external_internal_by_aspect:
  conjunction:
  - 0.55
  - 0.45
  sextile:
  - 0.4
  - 0.6
  square:
  - 0.65
  - 0.35
  trine:
  - 0.45
  - 0.55
  opposition:
  - 0.7
  - 0.3
points_supported:
- Vertex
- AntiVertex
- NorthNode
- SouthNode
- Chiron
- Fortune
orbs_deg_by_transit_for_points:
  Vertex: 2.0
  AntiVertex: 2.0
  NorthNode: 3.0
  SouthNode: 3.0
  Chiron: 2.5
  Fortune: 2.0
weights_by_transit_to_points:
  Vertex: 1.05
  AntiVertex: 0.95
  NorthNode: 0.85
  SouthNode: 0.8
  Chiron: 0.8
  Fortune: 0.75
angles_supported:
- ASC
- MC
- DSC
- IC
orbs_deg_angles: 2.0
weights_to_angles:
  ASC: 1.2
  MC: 1.25
  DSC: 1.1
  IC: 1.1
lunar_cycles:
  predictive:
  - type: new_moon
  - type: full_moon
  - type: eclipse_solar
  - type: eclipse_lunar
  interpretive:
  - type: first_quarter
  - type: last_quarter
  - type: lunar_return
modules:
  transits:
    enabled: true
    dataset_type: ephemeris_hourly
    multiplier: 1.0
  composite_synastry:
    enabled: true
    composite_type: composite_chart
    synastry_type: synastry_aspects
    multiplier_composite: 1.1
    multiplier_synastry: 0.95
    orb_scale: 0.95
  secondary_progressions:
    enabled: true
    dataset_type: progressions_solararc
    channel: progressed
    multiplier: 0.85
    orb_scale: 0.9
  solar_arc:
    enabled: true
    dataset_type: progressions_solararc
    channel: solar_arc
    multiplier: 0.9
    orb_scale: 0.9
  harmonics:
    enabled: true
    dataset_type: harmonics
    multiplier: 0.6
    orb_scale: 0.8
  draconic:
    enabled: true
    dataset_type: draconic
    multiplier: 0.7
    orb_scale: 0.85
  davison:
    enabled: true
    composite_type: davison_composite
    multiplier: 0.75
    orb_scale: 0.9
  declination_parallels:
    enabled: true
    max_orb_deg_equiv: 0.5
    weight: 0.85
  midpoints:
    enabled: true
    orb_deg: 1.5
    weight: 0.7
  house_fields:
    enabled: true
    cusp_orb_deg: 1.5
    weights_by_house_hint:
      '1': 1.0
      '2': 0.6
      '3': 0.7
      '4': 0.8
      '5': 0.75
      '6': 0.7
      '7': 1.0
      '8': 0.85
      '9': 0.7
      '10': 1.0
      '11': 0.65
      '12': 0.75
  channels_system:
    version: 1.4
    description: 'Unified channel architecture for AP-SUPER with owner-aware instances
      and degree-rate time solving. Everything computes; gates decide admission. v1.4
      adds run presets, stricter noise caps, eclipse shaping, and crosschecks for
      owner consistency.

      '
    ap_super:
      mode: always_on_then_gate
      thresholds:
        symbolic_detect_score: 0.15
        corridor_include:
          individual: 0.35
          composite: 0.35
        flashpoint:
          individual: 0.6
          composite: 0.6
      orbs_deg:
        majors_default: 2.0
        minors_default: 1.5
        moon_major: 2.5
        draconic_major: 1.5
        harmonics_major: 0.8
        asteroids_major: 1.0
        fixed_stars: 0.5
      eclipse:
        aspects:
        - conjunction
        - opposition
        active_window_days:
        - -21
        - 30
        weight: 0.85
        require_contact_with:
        - ASC
        - DSC
        - IC
        - MC
        - Sun
        - Moon
        - Venus
        - Nodes
        decay_curve: linear
      synergy:
        pair_bonus_pct: 0.15
        triple_bonus_pct: 0.25
        quad_bonus_pct: 0.35
        conflict_dampen_mult: 0.4
      caps:
        channel_cap_mult: 1.4
        combined_master_cap_mult: 1.3
        optional_layers_cap_fraction_of_anchor: 0.3
      dedupe:
        collapse_same_transit_planet_and_aspect_family: true
        synastry_per_transit_planet_top_hits: 1
      gating:
        require_theme_match_for_mods: true
        off_theme_mod_fraction: 0.2
      mundane:
        enabled: false
      fixed_star_whitelist:
      - Regulus
      - Spica
      - Fomalhaut
      - Aldebaran
      - Antares
      asteroid_allow_list:
      - Chiron
      - Juno
      - Vesta
      - Pallas
      - Eros
      - Psyche
    time_solver:
      kind: degree_rate_linear
      aspects:
      - conjunction
      - sextile
      - square
      - trine
      - opposition
      sources:
        transits: ephem_hourly_2025
        progressed: structured_file
        directed: structured_file
      solve:
        method: linear_relative
        epsilon_rel_speed_deg_per_day: 0.01
      validation:
        orb_check: true
        recompute_delta_at_t: true
      outputs:
        include_t_exact_hours: true
        include_delta_at_t_deg: true
        include_admit_flags:
        - symbolic
        - corridor
        - flashpoint
    individual_channel:
      contributors:
        natal:
          weight: 1.0
          type: natal
        progressions:
          weight: 0.8
          type: progression
          time_solver_ref: ${modules.channels_system.time_solver}
          owner_field: Owner
        solar_arc:
          weight: 0.75
          type: solar_arc
          time_solver_ref: ${modules.channels_system.time_solver}
          owner_field: Owner
        draconic:
          weight: 0.7
          type: draconic
          major_orb_deg: ${modules.channels_system.ap_super.orbs_deg.draconic_major}
          modifier: true
        harmonics:
          weight: 0.45
          type: harmonics
          major_orb_deg: ${modules.channels_system.ap_super.orbs_deg.harmonics_major}
          majors_only: true
          modifier: true
        asteroids:
          weight: 0.6
          type: asteroids
          allow_list: ${modules.channels_system.ap_super.asteroid_allow_list}
          major_orb_deg: ${modules.channels_system.ap_super.orbs_deg.asteroids_major}
          modifier: true
        fixed_stars:
          weight: 0.4
          type: fixed_stars
          whitelist: ${modules.channels_system.ap_super.fixed_star_whitelist}
          orb_deg: ${modules.channels_system.ap_super.orbs_deg.fixed_stars}
          modifier: true
        eclipses:
          weight: ${modules.channels_system.ap_super.eclipse.weight}
          type: eclipse
      thresholds:
        corridor_include: ${modules.channels_system.ap_super.thresholds.corridor_include.individual}
        flashpoint: ${modules.channels_system.ap_super.thresholds.flashpoint.individual}
      rules:
        synergy:
          pair_bonus_pct: ${modules.channels_system.ap_super.synergy.pair_bonus_pct}
          triple_bonus_pct: ${modules.channels_system.ap_super.synergy.triple_bonus_pct}
          quad_bonus_pct: ${modules.channels_system.ap_super.synergy.quad_bonus_pct}
          conflict_dampen_mult: ${modules.channels_system.ap_super.synergy.conflict_dampen_mult}
        caps:
          per_hour_channel_cap_mult: ${modules.channels_system.ap_super.caps.channel_cap_mult}
          optional_layers_cap_fraction_of_anchor: ${modules.channels_system.ap_super.caps.optional_layers_cap_fraction_of_anchor}
        gating:
          require_theme_match_for_mods: ${modules.channels_system.ap_super.gating.require_theme_match_for_mods}
          off_theme_mod_fraction: ${modules.channels_system.ap_super.gating.off_theme_mod_fraction}
        dedupe:
          collapse_same_transit_planet_and_aspect_family: ${modules.channels_system.ap_super.dedupe.collapse_same_transit_planet_and_aspect_family}
    composite_channel:
      contributors:
        midpoint_composite:
          weight: 1.0
          type: composite
        davison:
          weight: 0.8
          type: davison
        draconic_composite:
          weight: 0.7
          type: draconic_composite
          major_orb_deg: ${modules.channels_system.ap_super.orbs_deg.draconic_major}
          modifier: true
        synastry_directional:
          weight: 0.6
          type: synastry
          use_stronger_direction_only: true
          majors_orb_deg: 2.0
          minors_orb_deg: 1.5
        eclipses:
          weight: ${modules.channels_system.ap_super.eclipse.weight}
          type: eclipse
      thresholds:
        corridor_include: ${modules.channels_system.ap_super.thresholds.corridor_include.composite}
        flashpoint: ${modules.channels_system.ap_super.thresholds.flashpoint.composite}
      rules:
        synergy:
          window_hours: 6
          pair_bonus_pct: ${modules.channels_system.ap_super.synergy.pair_bonus_pct}
          triple_bonus_pct: ${modules.channels_system.ap_super.synergy.triple_bonus_pct}
          quad_bonus_pct: ${modules.channels_system.ap_super.synergy.quad_bonus_pct}
          conflict_dampen_mult: ${modules.channels_system.ap_super.synergy.conflict_dampen_mult}
        caps:
          per_hour_channel_cap_mult: ${modules.channels_system.ap_super.caps.channel_cap_mult}
          optional_layers_cap_fraction_of_anchor: ${modules.channels_system.ap_super.caps.optional_layers_cap_fraction_of_anchor}
        gating:
          require_theme_match_for_mods: ${modules.channels_system.ap_super.gating.require_theme_match_for_mods}
          off_theme_mod_fraction: ${modules.channels_system.ap_super.gating.off_theme_mod_fraction}
        dedupe:
          collapse_same_transit_planet_and_aspect_family: ${modules.channels_system.ap_super.dedupe.collapse_same_transit_planet_and_aspect_family}
      export:
        direction_labels:
        - A_weighted
        - B_weighted
        - Balanced
        initiation_tags:
        - A_break
        - B_break
        - A_reconnect
        - B_reconnect
        - Shared
        - Mixed
    instances:
      chris_individual:
        channel_ref: individual_channel
        data_filter:
          owner_field: Owner
          owner_value: Chris
      remy_individual:
        channel_ref: individual_channel
        data_filter:
          owner_field: Owner
          owner_value: Remy
      composite:
        channel_ref: composite_channel
    integration:
      activation:
        chris_only:
        - chris_individual
        chris_and_remy:
        - chris_individual
        - remy_individual
        chris_remy_comp:
        - chris_individual
        - remy_individual
        - composite
      weights:
        chris_individual: 1.0
        remy_individual: 1.0
        composite: 1.0
      normalization: true
      caps:
        combined_master_cap_mult: ${modules.channels_system.ap_super.caps.combined_master_cap_mult}
      guards:
        composite_not_exceed_individuals_plus_personal_eclipses: true
    run_presets:
      june_trip:
        timezone: America/New_York
        start: '2025-06-06T00:00:00'
        end: '2025-06-10T00:00:00'
        step_hours: 1
        active_instances:
        - chris_individual
        - remy_individual
        - composite
    contributors_registry:
      data_sources:
        ephemeris_hourly_2025: ephem_hourly_2025.csv
        ephemeris_broad: Ephemeris 1900-2050 0.25 month steps.csv
        chris_natal: Chris_Natal_Chart_Data_Placidus.csv
        remy_natal: Remy_Natal_Chart_Data_Placidus.csv
        combined_composite: Chris_Remy_Combined_Charts_Structured.csv
        draconic_structured: Chris_Remy_Draconic_Natal_Structured.csv
        harmonics_structured: Chris_Remy_Harmonics_1-12_with_numbers.csv
        synastry_structured: Chris_Remy_Synastry_Aspects.csv
        transit_prog_arc_structured: Chris_Remy_Transit_Progressed_SolarArc_Labeled.csv
        usa_sibly_natal: USA_Sibly_Natal_clean.csv
        usa_sibly_other: USA_Sibly_Other_Data.csv
        event_log: Structured_Event_Log_v1.5.0_clean.csv
        individuals_registry: ASTROLOGY_INDIVIDUALS_v1.5.0_clean.csv
    preflight:
      required_files:
      - ${modules.channels_system.contributors_registry.data_sources.ephemeris_hourly_2025}
      - ${modules.channels_system.contributors_registry.data_sources.chris_natal}
      - ${modules.channels_system.contributors_registry.data_sources.remy_natal}
      - ${modules.channels_system.contributors_registry.data_sources.transit_prog_arc_structured}
      - ${modules.channels_system.contributors_registry.data_sources.combined_composite}
      required_columns_in_transit_prog_arc_structured:
      - Owner
      - Body Name
      - Longitude
      - Daily Travel
      - Technique
      required_owners:
      - Chris
      - Remy
      fail_hard_on_missing: true
    crosschecks:
      owner_consistency:
        method: progressed_sun_fingerprint
        window: 2025-06-01/2025-06-12
        tolerance_deg: 5.0
      logging:
        include_components:
        - included_hits
        - excluded_hits
        - reason_codes
        - caps_triggers
        - synergy_events
        - ownership_labels
        - initiation_tags
dataset_resolver:
  ephemeris_hourly:
  - ephem_hourly_*.csv
  - ephemeris_hourly_*.csv
  progressions_solararc:
  - '*Transit_Progressed_SolarArc*_*.csv'
  - '*Transit_Progressed_SolarArc*.csv'
  composite_chart:
  - '*Combined_Charts*_*.csv'
  - '*Combined_Charts*.csv'
  davison_composite:
  - '*Davison*_*.csv'
  - '*Davison*.csv'
  harmonics:
  - '*Harmonics*1-12**.csv'
  - '*Harmonics*1-12*.csv'
  - '*Harmonics*.csv'
  draconic:
  - '*Draconic*Structured*.csv'
  - '*Draconic*.csv'
  broad_ephemeris:
  - Ephemeris*1900-2050*0.25*month*steps*.csv
  - Ephemeris*1900-2050*.csv
  synastry_aspects:
  - '*Synastry_Aspects*_*.csv'
  - '*Synastry_Aspects*.csv'
profiles:
  AP-LITE:
    include_modules:
    - transits
    include_points:
    - Vertex
    - AntiVertex
    comment: Minimal, fast scan with contact gates.
  AP-SUPER:
    include_modules:
    - transits
    - composite_synastry
    - secondary_progressions
    - solar_arc
    include_points:
    - Vertex
    - AntiVertex
    - NorthNode
    - SouthNode
    - Chiron
    - Fortune
    comment: Validated signal only. Interpretive channels evaluated but tag-only unless
      promoted.
  AP-EXTREME:
    include_modules:
    - transits
    - composite_synastry
    - secondary_progressions
    - solar_arc
    - harmonics
    - draconic
    - davison
    - declination_parallels
    - midpoints
    - house_fields
    include_points:
    - Vertex
    - AntiVertex
    - NorthNode
    - SouthNode
    - Chiron
    - Fortune
    comment: Kitchen sink; everything contributes.
  DEBUG:
    include_modules:
    - transits
    - composite_synastry
    - secondary_progressions
    - solar_arc
    include_points:
    - Vertex
    - AntiVertex
    - NorthNode
    - SouthNode
    - Chiron
    - Fortune
    debug_output: all_hits_per_hour
    comment: Same as AP-SUPER, but dumps full hit lists pre-corridor.
interpretive_channels:
  evaluate_always: true
  noise_floor:
    min_orb_closeness: 0.25
    min_unit_weight: 0.3
  tiers:
    tag_min_orb_closeness: 0.4
    tag_min_unit_weight: 0.5
    promote_min_orb_closeness: 0.6
    promote_min_unit_weight: 0.8
  promotion:
  - name: reinforce_predictive_peak
    within_minutes: 90
    min_reinforcing_hits: 2
    min_symbolic_weight_sum: 1.2
    adds_weight_scale: 0.5
    max_stack_fraction: 0.3
  - name: rare_symbolic_exact
    within_minutes: 60
    tight_orb_deg: 0.5
    min_symbolic_weight_sum: 1.5
    adds_weight_scale: 0.35
    max_stack_fraction: 0.25
  channel_scales:
    harmonics:
      promote_scale: 0.3
      tag_label: Harmonics resonance
    draconic:
      promote_scale: 0.35
      tag_label: Draconic overlay
    davison:
      promote_scale: 0.35
      tag_label: Davison tone
    declination_parallels:
      promote_scale: 0.5
      tag_label: Declination parallel
    midpoints:
      promote_scale: 0.4
      tag_label: Midpoint hit
    house_fields:
      promote_scale: 0.3
      tag_label: House field
    lunar_cycles:
      interpretive:
        promote_scale: 0.3
        tag_label: Lunar cycle (context)
  tagging:
    include_minor_aspects: true
    include_notes: true
  ledger:
    enabled: true
    include:
    - ignored_count
    - tagged_list
    - promoted_list
    - added_weight_sum
probability_corridor:
  apply: true
  thresholds:
    low_max: 0.35
    med_max: 0.65
  normalization:
    mode: zscore_tanh_pm100
    center: median
    scale: MAD_to_sigma
    clip_pm: 100
visualization:
  enabled: false
  style: valence_aware_multi
  show_bands: false
  show_threshold_lines: false
  defaults:
    index_range:
    - -100
    - 100
    baseline_zero: true
    shade_method: top_percentile
    percentile: 90
