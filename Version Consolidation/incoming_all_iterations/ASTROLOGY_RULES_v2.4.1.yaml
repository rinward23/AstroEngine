# Astrology Rules — v2.4.1 (adds 'Native Overlay' visualization option)
# Extends v2.4.0; no changes to calculations or integrity rules. This ONLY adds
# an optional visualization preset mirroring the example (individuals overlay,
# composite, and combined index), with 30‑minute cadence derived from hourly data.
version: "2.4.1"
extends: "ASTROLOGY_RULES_v2.4.0.yaml"

charts:
  default_view: "tier_split"   # unchanged default (Minor/Moderate/Major panels)
  views:

    tier_split:
      enabled: true
      description: "Three-panel Minor/Moderate/Major event tiers (locked style)."

    native_overlay:
      enabled: true
      description: "Three panels: (1) Individuals overlaid, (2) Composite only, (3) Combined index = mean(Chris, Remy, Composite)."
      cadence:
        base: "hourly"         # compute corridor from hourly ephemeris (required)
        resample_to: "30min"   # OPTIONAL finer display
        method: "linear"       # linear interpolation from computed hourly corridor
      panels:
        - id: "individuals_overlay"
          title: "Native 30‑Minute Probability — Chris & Remy with Event Overlays"
          series:
            - {name: "Chris",     color: "#0B63FF"}    # blue
            - {name: "Remy",      color: "#2BA84A"}    # green
          fill_under: true
          hatch: "///"
          overlays:
            clusters: {enabled: true}      # shaded windows from clustering
            events:   {enabled: false}     # dashed markers optional (default off)

        - id: "composite_only"
          title: "Native 30‑Minute Probability — Composite with Event Overlays"
          series:
            - {name: "Composite", color: "#7E22CE"}    # purple
          fill_under: true
          hatch: "///"
          overlays:
            clusters: {enabled: true}
            events:   {enabled: false}

        - id: "combined_index"
          title: "Native 30‑Minute Probability — Combined Index ⟨Chris + Remy + Composite⟩/3 with Event Overlays"
          series:
            - {name: "Combined Index", color: "#111111", combine: "mean", of: ["Chris","Remy","Composite"]}
          fill_under: true
          hatch: "///"
          overlays:
            clusters: {enabled: true}
            events:   {enabled: false}

  render_locked: true
  y_range: [-100, 100]
  line_style: "steps-mid"
  label_style:
    font_size: 10
    readable_label_colors: {yellow: "darkgoldenrod", orange: "saddlebrown", red: "darkred"}

router:
  # Optional: simple patterns to request this view in natural language.
  views:
    patterns:
      native_overlay:
        - "(?i)\\b(native overlay|individuals overlay|combined index|three panels like before|30\\s*minute view)\\b"
      tier_split:
        - "(?i)\\b(tier split|minor moderate major|event tiers)\\b"
